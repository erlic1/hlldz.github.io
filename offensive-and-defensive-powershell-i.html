<!DOCTYPE html>
<html lang=tr>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="PowerShell is a powerful shell, as can be understood from the name. It has been developed to facilitate system administrators’ work and system dominance. As you can see in the graphic below, PowerShel">
<meta property="og:type" content="article">
<meta property="og:title" content="Offensive and Defensive PowerShell - I">
<meta property="og:url" content="https://artofpwn.com/offensive-and-defensive-powershell-i.html">
<meta property="og:site_name" content="with knowledge comes power">
<meta property="og:description" content="PowerShell is a powerful shell, as can be understood from the name. It has been developed to facilitate system administrators’ work and system dominance. As you can see in the graphic below, PowerShel">
<meta property="og:image" content="https://artofpwn.com/images/offensive-and-defensive-powershell-i/graph.png">
<meta property="og:image" content="https://artofpwn.com/images/offensive-and-defensive-powershell-i/cmdlets.png">
<meta property="og:image" content="https://artofpwn.com/images/offensive-and-defensive-powershell-i/pipeline.png">
<meta property="og:image" content="https://artofpwn.com/images/offensive-and-defensive-powershell-i/powershell-remoting.png">
<meta property="og:image" content="https://artofpwn.com/images/offensive-and-defensive-powershell-i/execution-policy.png">
<meta property="og:updated_time" content="2017-09-23T18:15:28.667Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Offensive and Defensive PowerShell - I">
<meta name="twitter:description" content="PowerShell is a powerful shell, as can be understood from the name. It has been developed to facilitate system administrators’ work and system dominance. As you can see in the graphic below, PowerShel">
<meta name="twitter:image" content="https://artofpwn.com/images/offensive-and-defensive-powershell-i/graph.png">
    
    
        
          
              <link rel="shortcut icon" href="/">
          
        
        
          
            <link rel="icon" type="image/png" href="/" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/">
          
        
    
    <!-- title -->
    <title>Offensive and Defensive PowerShell - I</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
<link rel="stylesheet" href="/css/prism-okaidia.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/hlldz">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/powershell-ve-ransomware.html"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://artofpwn.com/offensive-and-defensive-powershell-i.html"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&text=Offensive and Defensive PowerShell - I"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&is_video=false&description=Offensive and Defensive PowerShell - I"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Offensive and Defensive PowerShell - I&body=Check out this article: https://artofpwn.com/offensive-and-defensive-powershell-i.html"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&name=Offensive and Defensive PowerShell - I&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#PowerShell"><span class="toc-number">1.</span> <span class="toc-text">PowerShell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cmdlet"><span class="toc-number">2.</span> <span class="toc-text">Cmdlet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pipeline"><span class="toc-number">3.</span> <span class="toc-text">Pipeline</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Remoting"><span class="toc-number">4.</span> <span class="toc-text">Remoting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enabling-Remoting"><span class="toc-number">5.</span> <span class="toc-text">Enabling Remoting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-Remoting-Works"><span class="toc-number">6.</span> <span class="toc-text">How Remoting Works?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Execution-Policy"><span class="toc-number">7.</span> <span class="toc-text">Execution Policy</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Offensive and Defensive PowerShell - I
    </h1>



    <div class="meta">
      
    <div class="postdate">
        <time datetime="2017-09-23T19:00:00.000Z" itemprop="datePublished">23/09/2017</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/defensive-powershell/">defensive powershell</a>, <a class="tag-link" href="/tags/offensive-powershell/">offensive powershell</a>, <a class="tag-link" href="/tags/powershell/">powershell</a>, <a class="tag-link" href="/tags/windows/">windows</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>PowerShell is a powerful shell, as can be understood from the name. It has been developed to facilitate system administrators’ work and system dominance. As you can see in the graphic below, PowerShell is one of the most used languages on GitHub. A language that is popular in this way is popular by system administrators, but it has attracted the attention of the offensive side because it is strong. The fact that PowerShell is heavily used in many cyber attacks is proof of this. The attention of the offensive side and intensive use means that the defensive side will eventually pay attention and concentrate on it.</p>
<p><img src="/images/offensive-and-defensive-powershell-i/graph.png" alt="Language Graph on GitHub" title="Language Graph on GitHub"> <div style="text-align: center;font-size: 12px;">Language Graph on GitHub</div></p>
<p>The article is prepared to answer these questions and give an idea. How to attack systems using PowerShell? How to bypass PowerShell security precautions? and How to identify attacks used PowerShell? How to protect PowerShell environment?</p>
<h2 id="PowerShell"><a href="#PowerShell" class="headerlink" title="PowerShell"></a>PowerShell</h2><p>PowerShell (PowerShell Core) is an advanced command line application developed by Microsoft as an alternative to Windows Command Prompt (cmd.exe) and Windows Script Host. Microsoft has improved PowerShell to simplify management tasks and solve problems quickly. It greatly simplifies the tasks of system administrators and allows system administrators to easily access and perform tasks through PowerShell on systems located in both local and remote environments. For example, a system administrator can do almost anything on Active Directory without ever using the graphical interface simply by using PowerShell.</p>
<p>System administrators can customize their operations with PowerShell Scripts that they develop, or they can use the specific commands that come with the default Verb-Noun naming scheme called Cmdlet. PowerShell has full access to system functions. So with WMI and COM objects almost anything you want can be done. However, full access to the .NET Framework is also possible.</p>
<p>In the future, PowerShell will replace the traditional Command Prompt and will be the default Windows terminal interface. With the release of source code in 2016, PowerShell has been available on Linux and Mac OS X operating systems, as well as Windows operating systems. The first version (PowerShell v1.0) was released for Windows XP SP2, Windows Server 2003 and Windows Vista operating systems in 2006, and these operating systems need to be installed later to use PowerShell. PowerShell is installed by default on all Windows operating systems after Vista and Server 2008.</p>
<p>The following table shows the default PowerShell (with installation) version and the supported version information.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Operating System</th>
<th style="text-align:center">Installled Version</th>
<th style="text-align:center">Supported Versions</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">2.0</td>
<td style="text-align:center">2.0, 3.0, 4.0</td>
</tr>
<tr>
<td style="text-align:center">Server 2008 R2</td>
<td style="text-align:center">2.0</td>
<td style="text-align:center">2.0, 3.0, 4.0</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">3.0</td>
<td style="text-align:center">3.0</td>
</tr>
<tr>
<td style="text-align:center">Server 2012</td>
<td style="text-align:center">3.0</td>
<td style="text-align:center">3.0, 4.0</td>
</tr>
<tr>
<td style="text-align:center">8.1</td>
<td style="text-align:center">4.0</td>
<td style="text-align:center">4.0</td>
</tr>
<tr>
<td style="text-align:center">Server 2012 R2</td>
<td style="text-align:center">4.0</td>
<td style="text-align:center">4.0</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">5.0</td>
<td style="text-align:center">2.0, 3.0, 4.0</td>
</tr>
<tr>
<td style="text-align:center">Server 2016</td>
<td style="text-align:center">5.0</td>
<td style="text-align:center">2.0, 3.0, 4.0</td>
</tr>
</tbody>
</table>
<h2 id="Cmdlet"><a href="#Cmdlet" class="headerlink" title="Cmdlet"></a>Cmdlet</h2><p>Cmdlet’s (Command-Let) are by default specific commands and they have Verb-Noun naming patterns (eg Get-Service, GetProcess). They are different from normal commands because Cmdlets are .NET Framework Classes, not standalone executable.</p>
<pre class="line-numbers language-terminal"><code class="language-terminal">Windows PowerShell
Copyright (C) 2016 Microsoft Corporation. All rights reserved.

PS C:\Users\hlldz> Get-Process
Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
-------  ------    -----      -----     ------     --  -- -----------
    232      13     3760      15864       0,09   1376   1 conhost
    228      12     3756      15344       0,55   3108   1 conhost
    227      13     3800      17480       0,06   4600   1 conhost
    232      12     3756      14796       0,48   4880   1 conhost
    388      12     1492       3588               580   0 csrss
    296      15     1556       3748               660   1 csrss
...
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>If you want to see what the Cmdlets in PowerShell are or if you want to call any desired Cmdlets, you can do this using the <strong>Get-Command</strong> Cmdlet. The following screenshot shows the use of command.</p>
<p><img src="/images/offensive-and-defensive-powershell-i/cmdlets.png" alt="Get-Command Cmdlet" title="Get-Command Cmdlet"> <div style="text-align: center;font-size: 12px;">Get-Command Cmdlet</div></p>
<h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><p>The Pipeline is a set of data processing elements connected in series, where the output of one element is the input of the next one. PowerShell supports the Pipeline. So PowerShell; you can easily make changes to multiple items or a specific subset of thousands of items with a single line of code, or use these objects to collect data or perform actions on other related objects.</p>
<p><img src="/images/offensive-and-defensive-powershell-i/pipeline.png" alt="Pipeline" title="Pipeline"> <div style="text-align: center;font-size: 12px;">Pipeline</div></p>
<h2 id="Remoting"><a href="#Remoting" class="headerlink" title="Remoting"></a>Remoting</h2><p>The Remoting feature that comes with PowerShell v2 allows system administrators to access and manage other systems from a central point through PowerShell. With PowerShell v3, the Remoting feature has been refreshed and improved. This feature not only covers Windows systems but also Linux and Mac OS X operating systems. Once PowerShell has been open source, it has also been available for the relevant operating systems.</p>
<p>For example, you want to access PowerShell on the remote system, run a command, or run any PowerShell script. One of the first things that comes to mind is that you can do Remote Desktop Connection (RDP), then access PowerShell and get it done, but with PowerShell Remoting it is not necessary. For this process, Remoting must be enabled on the target system. Just like SSH connection to remote systems and access to terminal interface.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Operating System</th>
<th style="text-align:center">Default Remoting State</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">Disable</td>
</tr>
<tr>
<td style="text-align:center">Server 2008 R2</td>
<td style="text-align:center">Disable</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">Disable</td>
</tr>
<tr>
<td style="text-align:center">Windows Server 2012</td>
<td style="text-align:center">Enable</td>
</tr>
<tr>
<td style="text-align:center">8.1</td>
<td style="text-align:center">Disable</td>
</tr>
<tr>
<td style="text-align:center">Windows Server 2012 R2</td>
<td style="text-align:center">Enable</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">Disable</td>
</tr>
<tr>
<td style="text-align:center">Server 2016</td>
<td style="text-align:center">Enable</td>
</tr>
</tbody>
</table>
<p>PowerShell’s Remoting feature allows you to run scripts and scripts on remote systems. Many Cmdlets in PowerShell also have additional features such as working in remote systems and getting the results. Instead of providing this feature for each cmdlet, Microsoft has developed the Remoting feature so that all infrastructure can communicate on one protocol.</p>
<h2 id="Enabling-Remoting"><a href="#Enabling-Remoting" class="headerlink" title="Enabling Remoting"></a>Enabling Remoting</h2><p>The <strong>Enable-PSRemoting</strong> Cmdlet can be used to activate the remoting feature. When running with Cmdlet <strong>-Force</strong> parameter, Remoting service will be activated directly without any confirmation and the necessary settings will be made. When the cmdlet is used without the <strong>-Force</strong> parameter, it will be asked for confirmation. The operations are to start the WinRM service and set it to run automatically at startup, to set up the listener, and to start listening to any IP address connections, activating Firewall rules for the Remoting ports.</p>
<h2 id="How-Remoting-Works"><a href="#How-Remoting-Works" class="headerlink" title="How Remoting Works?"></a>How Remoting Works?</h2><p>In Figure 4 below, the working infrastructure of the PowerShell Remoting feature has been tried to be schematized. The Client 1 system tries to connect to the Client 2 system via PowerShell’s Remoting feature.</p>
<p><img src="/images/offensive-and-defensive-powershell-i/powershell-remoting.png" alt="PowerShell Remoting" title="PowerShell Remoting"> <div style="text-align: center;font-size: 12px;">PowerShell Remoting</div></p>
<p>1- The Client 1 system communicates with its own Web Services for Management (WSMan) service. WSMan is an HTTP (S)-based protocol with the ability to encapsulate many other protocols. The remoting feature uses the HTTP protocol by default, but the connection can be encrypted easily by using the HTTPS protocol.</p>
<p>2- On the client 2 system, the WinRM Service is running. This service can have one or more Listeners, and each Listener waits for WSMan traffic for a specific IP address and a specific port number from a specific protocol (HTTP or HTTPS). Listeners created by the WinRM service look for what traffic is about when they receive any traffic. We are talking about PowerShell here and a PowerShell session will start on the system of Client 2.</p>
<p>In Figure 4, the <strong>powershell.exe</strong> process seems to be starting in the system of Client 2, but this is done only for easy understanding. Under normal conditions, the process named <strong>wsmprovhost.exe</strong> will start, not <strong>powershell.exe</strong>.</p>
<h2 id="Execution-Policy"><a href="#Execution-Policy" class="headerlink" title="Execution Policy"></a>Execution Policy</h2><p>Execution Policy, are the policies that determine how it should work in which conditions for PowerShell. Execution Policy; can be set for the local system, any user or any PowerShell session. This can also be done via Group Policy for users or systems. The default Execution Policy levels in PowerShell are given in the following table.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Operating System</th>
<th style="text-align:center">Default Execution Policy Level</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">Restricted</td>
</tr>
<tr>
<td style="text-align:center">Server 2008 R2</td>
<td style="text-align:center">Restricted</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">Restricted</td>
</tr>
<tr>
<td style="text-align:center">Windows Server 2012</td>
<td style="text-align:center">Restricted</td>
</tr>
<tr>
<td style="text-align:center">8.1</td>
<td style="text-align:center">Restricted</td>
</tr>
<tr>
<td style="text-align:center">Windows Server 2012 R2</td>
<td style="text-align:center">Remote Signed</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">Restricted</td>
</tr>
<tr>
<td style="text-align:center">Server 2016</td>
<td style="text-align:center">Remote Signed</td>
</tr>
</tbody>
</table>
<p>Execution Policy is not a security measure as it is known and can be easily overcome. It has been developed to prevent the damage they cause users run the script by accident.</p>
<p><strong>Restricted</strong> is the most trusted policy because it allows only interactive PowerShell access. This means that you can only run commands individually. This policy is not concerned with where the scripts come from (via the local network or the internet), whether they are signed or not, and is not allowed to run any scripts.</p>
<p><strong>AllSigned,</strong> in this policy, only scripts signed by trusted authorities on PowerShell are allowed. In addition, when a signed script is executed, confirmation is requested.</p>
<p><strong>RemoteSigned</strong> can run scripts on the local system in this policy but must be signed by trusted authorities for scripts downloaded over the internet. Also, there is no need to get any confirmation while scripts are running.</p>
<p><strong>Unrestricted,</strong> no restrictions; all Windows PowerShell scripts can be run. The warning will only be displayed if the script is downloaded from the internet.</p>
<p><strong>Bypass,</strong> there is no restriction, no warning, or a confirmation mechanism in this policy. Every script can be run.</p>
<p><strong>Undefined,</strong> no Execution Policy is assigned. If no Execution Policy is assigned for the specified scopes, the Restriced policy will be assigned by default.</p>
<p>The <strong>Get-ExecutionPolicy</strong> Cmdlet can be used to find the Execution Policy level in PowerShell. If you want to change the level of Execution Policy, in PowerShell session running on <strong>Administrator</strong> rights; The <strong>Set-ExecutionPolicy <policy name=""></policy></strong> Cmdlet can be run.</p>
<p>At the same time, Execution Policy change without the need for any extra rights when starting a new PowerShell session <strong>-executionpolicy</strong> parameter is used. The value of the parameter can be set to whatever level is desired, the Execution Policy for the new PowerShell session to be started will be set as desired. The sample operation is shown in the following screen image.</p>
<p><img src="/images/offensive-and-defensive-powershell-i/execution-policy.png" alt="Execution Policy" title="Execution Policy"> <div style="text-align: center;font-size: 12px;">Execution Policy</div></p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/hlldz">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#PowerShell"><span class="toc-number">1.</span> <span class="toc-text">PowerShell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cmdlet"><span class="toc-number">2.</span> <span class="toc-text">Cmdlet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pipeline"><span class="toc-number">3.</span> <span class="toc-text">Pipeline</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Remoting"><span class="toc-number">4.</span> <span class="toc-text">Remoting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enabling-Remoting"><span class="toc-number">5.</span> <span class="toc-text">Enabling Remoting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-Remoting-Works"><span class="toc-number">6.</span> <span class="toc-text">How Remoting Works?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Execution-Policy"><span class="toc-number">7.</span> <span class="toc-text">Execution Policy</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://artofpwn.com/offensive-and-defensive-powershell-i.html"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&text=Offensive and Defensive PowerShell - I"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&is_video=false&description=Offensive and Defensive PowerShell - I"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Offensive and Defensive PowerShell - I&body=Check out this article: https://artofpwn.com/offensive-and-defensive-powershell-i.html"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&title=Offensive and Defensive PowerShell - I"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://artofpwn.com/offensive-and-defensive-powershell-i.html&name=Offensive and Defensive PowerShell - I&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2015 - 2017 | artofpwn.com
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/hlldz">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-88697757-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'artofpwn';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


