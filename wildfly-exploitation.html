<!DOCTYPE html>
<html lang=tr>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Once upon a time, I was working on a penetration test. All day, I looked for an entry point but there was no any exploitable vulnerability on customer systems. I couldn’t get any system neither low pr">
<meta property="og:type" content="article">
<meta property="og:title" content="Wildfly Exploitation">
<meta property="og:url" content="https://artofpwn.com/wildfly-exploitation.html">
<meta property="og:site_name" content="with knowledge comes power">
<meta property="og:description" content="Once upon a time, I was working on a penetration test. All day, I looked for an entry point but there was no any exploitable vulnerability on customer systems. I couldn’t get any system neither low pr">
<meta property="og:image" content="https://artofpwn.com/images/wildpwn/wildfly.png">
<meta property="og:image" content="https://artofpwn.com/images/wildpwn/java.png">
<meta property="og:image" content="https://artofpwn.com/images/wildpwn/wildpwn.png">
<meta property="og:image" content="https://raw.githubusercontent.com/hlldz/wildPwn/master/Nmap%20Scripts/wildfly-detect.png">
<meta property="og:image" content="https://raw.githubusercontent.com/hlldz/wildPwn/master/Nmap%20Scripts/wildfly-brute.png">
<meta property="og:updated_time" content="2017-05-13T09:44:20.325Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Wildfly Exploitation">
<meta name="twitter:description" content="Once upon a time, I was working on a penetration test. All day, I looked for an entry point but there was no any exploitable vulnerability on customer systems. I couldn’t get any system neither low pr">
<meta name="twitter:image" content="https://artofpwn.com/images/wildpwn/wildfly.png">
    
    
        
          
              <link rel="shortcut icon" href="/">
          
        
        
          
            <link rel="icon" type="image/png" href="/" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/">
          
        
    
    <!-- title -->
    <title>Wildfly Exploitation</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
<link rel="stylesheet" href="/css/prism-okaidia.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/hlldz">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/phant0m-killing-windows-event-log.html"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://artofpwn.com/wildfly-exploitation.html"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://artofpwn.com/wildfly-exploitation.html&text=Wildfly Exploitation"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://artofpwn.com/wildfly-exploitation.html&is_video=false&description=Wildfly Exploitation"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Wildfly Exploitation&body=Check out this article: https://artofpwn.com/wildfly-exploitation.html"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://artofpwn.com/wildfly-exploitation.html&name=Wildfly Exploitation&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">1.</span> <span class="toc-text">Exploitation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap-Scripts"><span class="toc-number">2.</span> <span class="toc-text">Nmap Scripts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">3.</span> <span class="toc-text">References</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Wildfly Exploitation
    </h1>



    <div class="meta">
      
    <div class="postdate">
        <time datetime="2017-05-13T10:00:00.000Z" itemprop="datePublished">13/05/2017</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/java/">java</a>, <a class="tag-link" href="/tags/linux/">linux</a>, <a class="tag-link" href="/tags/wildfly/">wildfly</a>, <a class="tag-link" href="/tags/windows/">windows</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>Once upon a time, I was working on a penetration test. All day, I looked for an entry point but there was no any exploitable vulnerability on customer systems. I couldn’t get any system neither low privileges nor high privileges. During the penetration test, I found a default/predictable credentials on WildFly Application Server. I hadn’t heart that application before. I searched on internet it and there wasn’t anything on internet about the Wildfly exploitation. So I decided analyze the application, “How can I get system over the Wildfly application?”</p>
<p><img src="/images/wildpwn/wildfly.png" alt="Wildfly" title="Wildfly"></p>
<p>After a couple of time I figured out;</p>
<p>WildFly, formerly known as JBoss AS, or simply JBoss, is an application server authored by JBoss, now developed by Red Hat. WildFly is written in Java, and implements the Java Platform, Enterprise Edition (Java EE) specification. It runs on multiple platforms. WildFly is free and open-source software, subject to the requirements of the GNU Lesser General Public License (LGPL), version 2.1.<sup>1</sup></p>
<p>As written above description, Wildfly is an application server based on Java. If you get a Java-based application, should not it be so hard to get the system? As you know three billion devices run Java. :P</p>
<p><img src="/images/wildpwn/java.png" alt="Java" title="Java"></p>
<h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>After accessing that credentials, I saw my customer using an application on Wildfly which has a .WAR extension.</p>
<p>I can exploit that system like exploiting Tomcat!? No, unfortunately Wildfly did not worked the .WAR file which I created for Tomcat or Glassfish before. I read Wildfly documentation and I found how to create averagely a .WAR file for Wildfly. So, I create my own customized .WAR shell. </p>
<p>Wildfly wants a directory which is called WEB-INF and I created custom a “jboss-web.xml” file under the WEB-INF directory. The jboss-web.xml must contain simply following lines;</p>
<pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jboss-web</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.jboss.com/xml/ns/javaee<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span> http://www.jboss.com/xml/ns/javaee http://www.jboss.org/j2ee/schema/jboss-web_5_1.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-root</span><span class="token punctuation">></span></span>/wildPwn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-root</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jboss-web</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>The <code>&lt;context-root&gt;</code> tag means, your application directory. If you write “wildPwn” it will be accessible under that directory. By the way, I used modified Laudanum’s cmd.jsp as shell for bypassing endpoint security solution. Finally I uploaded my .WAR file and I was accessed the shell using that URL schema; <a href="http://ipOrDomain.com:port/shellDirectory/shell.jsp" target="_blank" rel="external">http://ipOrDomain.com:port/shellDirectory/shell.jsp</a></p>
<p>After penetration test, I wrote a tool for Wildfly called wildPwn. It can accessable on Github, <a href="https://github.com/hlldz/wildPwn" target="_blank" rel="external">wildPwn Project</a>.</p>
<p>wildPwn can brute force the Wildfly and upload a shell for running system commands on target. You can access usage video on YouTube, <a href="https://www.youtube.com/watch?v=kTsPwA7QhLU" target="_blank" rel="external">wildPwn usage video</a>.</p>
<p><img src="/images/wildpwn/wildpwn.png" alt="wildPwn" title="wildPwn"></p>
<h2 id="Nmap-Scripts"><a href="#Nmap-Scripts" class="headerlink" title="Nmap Scripts"></a>Nmap Scripts</h2><p>Also Nmap scripts are ready for detection and brute force processes. You can access that scripts under Nmap Scripts directroy of <a href="https://github.com/hlldz/wildPwn/tree/master/Nmap%20Scripts" target="_blank" rel="external">wildPwn project</a>.</p>
<p>For detection,</p>
<pre class="line-numbers language-text"><code class="language-text">nmap --script wildfly-detect &lt;TARGET&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Sample output,</p>
<p><img src="https://raw.githubusercontent.com/hlldz/wildPwn/master/Nmap%20Scripts/wildfly-detect.png" alt="Wildfly Detection" title="Wildfly Detection"></p>
<p>For brute force,</p>
<pre class="line-numbers language-text"><code class="language-text">nmap -p 9990 --script wildfly-brute --script-args "userdb=usernameList.txt,passdb=passList.txt,hostname=domain.com" &lt;TARGET&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Sample output,</p>
<p><img src="https://raw.githubusercontent.com/hlldz/wildPwn/master/Nmap%20Scripts/wildfly-brute.png" alt="Wildfly Brute Force" title="Wildfly Brute Force"></p>
<p>Happy Hunting!</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><sup>1</sup> <a href="https://en.wikipedia.org/wiki/WildFly" target="_blank" rel="external">Wildfly - Wikipedia</a><br><sup>2</sup> <a href="https://docs.jboss.org/author/display/WFLY10/Documentation" target="_blank" rel="external">Wildfly Documentation</a></p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
    </div>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/hlldz">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploitation"><span class="toc-number">1.</span> <span class="toc-text">Exploitation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap-Scripts"><span class="toc-number">2.</span> <span class="toc-text">Nmap Scripts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">3.</span> <span class="toc-text">References</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://artofpwn.com/wildfly-exploitation.html"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://artofpwn.com/wildfly-exploitation.html&text=Wildfly Exploitation"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://artofpwn.com/wildfly-exploitation.html&is_video=false&description=Wildfly Exploitation"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Wildfly Exploitation&body=Check out this article: https://artofpwn.com/wildfly-exploitation.html"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://artofpwn.com/wildfly-exploitation.html&title=Wildfly Exploitation"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://artofpwn.com/wildfly-exploitation.html&name=Wildfly Exploitation&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2015 - 2017 | artofpwn.com
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/hlldz">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-88697757-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'artofpwn';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


